import{o as i,b as d,a as t,l as W,t as O,d as w,n as D,m as te,q as H,e as P,O as re,s as B,F as V,r as z,u as m,x as A,y as pe,z as Ce,A as Ee,B as Oe,C as Re,D as F,P as Ie,E as xe,G as Se,H as Me,_ as le,I as Pe,J as Ve,N as Ae,Z as Te,K as Ue,T as Le,L as Be,M as je,Q as De,R as ze,S as Ne,U as qe,V as Fe,W as se,k as I,X as ee,j as K,i as de,Y as oe,f as me,g as Q,c as J,w as L,$ as ae,v as Je,a0 as We,h as Qe,p as ue,a1 as ye,a2 as Xe}from"./app-cdd7beda.js";const He=["id","aria-labelledby"],Ke={class:"modal-content"},Ge={key:0,class:"modal-header"},Ze=["id"],Ye={class:"modal-body"},et={key:2,class:"modal-footer"},tt=t("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Отменить",-1),st=t("button",{type:"button",class:"btn btn-success","data-bs-dismiss":"modal"},"Подтвердить",-1),ot=[tt,st],N={__name:"Modal",props:{id:{type:String,default:"modal"},title:{type:String,default:null},class_size:{type:String,default:null},header:{type:Boolean,default:!0},footer:{type:Boolean,default:!1},clearFunction:{type:Function,default:null}},setup(e){return(s,o)=>(i(),d("div",{class:"modal fade",id:e.id,tabindex:"-1","aria-labelledby":e.id+"Label","aria-hidden":"true"},[t("div",{class:D(["modal-dialog",e.class_size])},[t("div",Ke,[e.header?(i(),d("div",Ge,[W(s.$slots,"title",{},()=>[t("h5",{class:"modal-title",id:e.id+"Label"},O(e.title),9,Ze)]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:o[0]||(o[0]=a=>e.clearFunction())})])):w("",!0),e.header?w("",!0):W(s.$slots,"header",{key:1}),t("div",Ye,[W(s.$slots,"body")]),e.footer?(i(),d("div",et,ot)):w("",!0),e.footer?w("",!0):W(s.$slots,"footer",{key:3})])],2)],8,He))}},he=te("main",()=>{const e=H([{partId:1,title:"Стандарт",image:"/images/logo_obed_go.jpg",slug:"standard"},{partId:2,title:"Экспресс",image:"/images/logo_obed_go.jpg",slug:"express"},{partId:3,title:"Премиум",image:"/images/logo_obed_go.jpg",slug:"premium"},{partId:4,title:"Собери сам",image:"/images/logo_obed_go.jpg",slug:"self"}]),s=P(0);function o(n=!0){if(s.value===0){s.value=1;return}n?s.value===4?s.value=1:s.value++:s.value===1?s.value=4:s.value--}function a(){if(s.value===0){re.get(route("main"));return}let n=e.find(c=>c.partId===s.value).slug??"";if(n==="self"){re.get(route("self"));return}re.get(route("products",n))}return{foodParts:e,part:s,changePosition:o,selectPart:a}}),at={class:"container upper-menu fixed-top d-none d-md-block"},nt={class:"row justify-content-between"},rt={class:"col-6 col-md-3 px-3"},lt=["onClick"],it=["src"],dt={__name:"TopMenu",setup(e){const{foodParts:s,part:o}=B(he());return(a,n)=>(i(),d("div",at,[t("div",nt,[(i(!0),d(V,null,z(m(s),c=>(i(),d("div",rt,[t("div",{class:D("item-tab "+(m(o)===c.partId?"active":"")),onClick:u=>o.value=c.partId},[t("h3",null,[t("img",{src:c.image,alt:""},null,8,it),A(O(c.title),1)])],10,lt)]))),256))])]))}},ut={data(){return{isSupported:!1,hasPermission:!1,isRecording:!1,isPaused:!1,chunks:[]}},methods:{async start(){if(!this.isRecording)try{this.$_stream=await this.getStream(),this.prepareRecorder(),this.$_mediaRecorder.start()}catch(e){this.$emit("error",e),console.error(e)}},stop(){this.isRecording&&(this.$_mediaRecorder.stop(),this.$_stream.getTracks().forEach(e=>e.stop()))},pause(){this.isRecording&&this.$_mediaRecorder.pause()},resume(){this.isPaused&&this.$_mediaRecorder.resume()},async getStream(){const e=await navigator.mediaDevices.getUserMedia(this.constraints);return this.$_stream=e,this.$emit("stream",e),e},prepareRecorder(){this.$_stream&&(this.$_mediaRecorder=new MediaRecorder(this.$_stream,{mimeType:this.mimeType}),this.$_mediaRecorder.ignoreMutedMedia=!0,this.$_mediaRecorder.addEventListener("start",()=>{this.isRecording=!0,this.isPaused=!1,this.$emit("start")}),this.$_mediaRecorder.addEventListener("resume",()=>{this.isRecording=!0,this.isPaused=!1,this.$emit("resume")}),this.$_mediaRecorder.addEventListener("pause",()=>{this.isPaused=!0,this.$emit("pause")}),this.$_mediaRecorder.addEventListener("dataavailable",e=>{e.data&&e.data.size>0&&this.chunks.push(e.data)},!0),this.$_mediaRecorder.addEventListener("stop",()=>{this.$emit("stop");const e=new Blob(this.chunks);e.size>0&&this.$emit("result",e),this.chunks=[],this.isPaused=!1,this.isRecording=!1},!0))}},mounted(){if(!navigator.mediaDevices&&!navigator.mediaDevices.getUserMedia){console.warn("Media Devices are not supported from your browser.");return}this.isSupported=!0}},ct=[ut],pt={mixins:ct,props:{mode:{type:String,default:"hold",validator:e=>["hold","press"].includes(e)}},methods:{stopRecording(){if(this.mode!=="press")return this.stop()},startRecording(){return this.isRecording&&this.mode==="press"?this.stop():this.start()}}};const ke=(e,s)=>{const o=e.__vccOpts||e;for(const[a,n]of s)o[a]=n;return o},mt=["audio/aac","audio/ogg","audio/wav","audio/webm"],ht={name:"VueRecordAudio",mixins:[pt],props:{mimeType:{type:String,default:"audio/webm",validator:e=>mt.includes(e)}},data(){return{constraints:{audio:!0}}}},gt=t("span",null,null,-1),vt=[gt];function ft(e,s,o,a,n,c){return e.isSupported?(i(),d("div",{key:0,class:D(["vue-audio-recorder",{active:e.isRecording,paused:e.isPaused}]),onMousedown:s[0]||(s[0]=(...u)=>e.startRecording&&e.startRecording(...u)),onMouseleave:s[1]||(s[1]=(...u)=>e.stopRecording&&e.stopRecording(...u)),onMouseup:s[2]||(s[2]=(...u)=>e.stopRecording&&e.stopRecording(...u)),onTouchstart:s[3]||(s[3]=(...u)=>e.startRecording&&e.startRecording(...u)),onTouchend:s[4]||(s[4]=(...u)=>e.stopRecording&&e.stopRecording(...u)),onTouchcancel:s[5]||(s[5]=(...u)=>e.stopRecording&&e.stopRecording(...u))},vt,34)):w("",!0)}const bt=ke(ht,[["render",ft]]);pe.add(Ce);pe.add(Ee);pe.add(Oe);Re.watch();var _e;const _t=((_e=window.document.getElementsByTagName("title")[0])==null?void 0:_e.innerText)||"Laravel",j=qe,X=Ne;window.axios=F;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";window.Pusher=Ie;window.Echo=new xe({broadcaster:"pusher",key:"37f1cfbd4bda023198c9",cluster:"eu",forceTLS:!0});const U=(e,s="success")=>{Fe().notify({group:"info",type:s,title:"Оповещение ОбедыGO",text:e})},yt={preLoad:1.3,error:"/images/logo_obed_go.jpg",loading:"/images/logo_obed_go.jpg",attempt:1};Se({title:()=>`${_t}`,resolve:e=>Me(`./Pages/${e}.vue`,Object.assign({"./Pages/Main.vue":()=>le(()=>import("./Main-9f3e2a52.js"),["assets/Main-9f3e2a52.js","assets/app-cdd7beda.js","assets/app-56b0fb39.css"]),"./Pages/Products.vue":()=>le(()=>import("./Products-47fc45ac.js"),["assets/Products-47fc45ac.js","assets/app-cdd7beda.js","assets/app-56b0fb39.css"]),"./Pages/Self.vue":()=>le(()=>import("./Self-31caf729.js"),["assets/Self-31caf729.js","assets/app-cdd7beda.js","assets/app-56b0fb39.css"])})),setup({el:e,App:s,props:o,plugin:a}){return Pe({render:()=>Ve(s,o)}).use(Ae,Te).use(a).use(Ue()).use(Le,yt).use(Be).use(je).component("v-select",De).mount(e)}}).then(()=>{ze.init({color:"#4B5563"})});const kt={components:{VueRecordAudio:bt},props:["phone","name","cansend"],data(){return{recommendations:!1,recordings:[]}},watch:{cansend:function(e){e&&this.send()}},methods:{send(){let e=new FormData;e.append("phone",this.phone),e.append("name",this.name);for(let s=0;s<this.recordings.length;s++){let o=this.recordings[s].data;console.log(o),e.append("files["+s+"]",o)}axios.post("../api/v2/obedy/voice",e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){U("Голосовое сообщение успешно отправлено!"),this.recordings=[]}).catch(function(){}),this.recordings=[]},removeRecord(e){this.recordings.splice(e,1)},onResult(e){this.recordings.push({src:window.URL.createObjectURL(e),data:e})}}},$t=t("h6",{class:"text-center"},[A("Запиши голосовое сообщение"),t("br"),t("strong",{class:"text-danger"},"Удерживай кнопку для записи!")],-1),wt={class:"d-flex justify-content-center mt-2"},Ct={key:0,class:"row d-flex justify-content-center mt-2"},Et={class:"col-12"},Ot={class:"recorded-audio"},Rt={class:"audio-container"},It=["src"],xt=["onClick"],St=t("i",{class:"fas fa-trash"},null,-1),Mt=[St];function Pt(e,s,o,a,n,c){const u=se("vue-record-audio");return i(),d("div",null,[$t,t("div",wt,[I(u,{mode:"hold",onResult:c.onResult},null,8,["onResult"])]),n.recordings.length>0?(i(),d("div",Ct,[t("div",Et,[t("div",Ot,[(i(!0),d(V,null,z(n.recordings,(h,k)=>(i(),d("div",{key:k,class:"recorded-item"},[t("div",Rt,[t("audio",{src:h.src,controls:""},null,8,It)]),t("div",null,[t("a",{onClick:r=>c.removeRecord(k),class:"button is-dark"},Mt,8,xt)])]))),128))])])])):w("",!0)])}const Vt=ke(kt,[["render",Pt]]),G=te("userStore",()=>{const e=window.localStorage.getItem("user")===null?H({name:"",phone:"",addresses:[],isAuthorized:!1}):H(JSON.parse(window.localStorage.getItem("user"))),s=Z();ee(e,r=>{localStorage.setItem("user",JSON.stringify(e))});async function o(){await F.post(route("register",e)).then(r=>{e.isAuthorized=!0,U("Вы успешно зарегистрировались!")}).catch(r=>{U("Произошла ошибка при регистрации","error")})}async function a(r){await F.post(route("login",r)).then(v=>(u(v.data),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=v.data.token,U("Вы успешно вошли в аккаунт!"),Promise.resolve(v))).catch(v=>Promise.reject(v))}async function n(){await F.post(route("logout")).then(r=>{e.isAuthorized=!1,window.axios.defaults.headers.common["X-CSRF-TOKEN"]=r.data.token,U("Вы успешно вышли из аккаунта!")}).catch(r=>{e.isAuthorized=!1})}async function c(){await F.get(route("user")).then(r=>{r.data.user.user===null?e.isAuthorized=!1:u(r.data.user),window.axios.defaults.headers.common["X-CSRF-TOKEN"]=r.data.token})}function u(r){e.name=r.user.name,e.phone=r.user.phone,e.addresses=r.user.addresses,e.isAuthorized=!0,s.addToCartFromBD(r.cart)}async function h(){await F.post(route("resend.code"),{phone:e.phone}).then(r=>(U("Код отправлен на ваш номера телефона"),Promise.resolve(r))).catch(r=>{U("Произошла ошибка при отправке кода","error")})}function k(){return e}return{user:e,register:o,login:a,logout:n,getUser:c,sendCode:h,dataUser:k}}),Z=te("cart",()=>{const e=window.localStorage.getItem("cart_items")===null?P([]):P(JSON.parse(window.localStorage.getItem("cart_items"))),s=K(g=>e.value.find(l=>l.product.id===g)??null),o=G(),a=K(()=>{if(e===null||e.value.length===0)return 0;let g=0;return e.value.forEach(l=>{g+=h(l)}),g}),n=K(()=>{if(e===null||e.value.length===0)return 0;let g=0;return e.value.forEach(l=>{g+=l.product.price*h(l)}),g}),c=K(()=>{if(e===null||e.value.length===0)return 0;let g=0;return e.value.forEach(l=>{l.product.weight>0&&(g+=l.product.weight*h(l)),l.product.weight===0&&l.product.positions.length>0&&l.product.positions.forEach(y=>{g+=y.weight})}),g});ee(a,g=>{localStorage.setItem("cart_items",JSON.stringify(e.value))});function u(g){let l=e.value.find(y=>y.product.id===g);return l?h(l):0}function h(g){return g.users.reduce((l,y)=>l+parseInt(y.quantity),0)}function k(g){let l=e.value.find(y=>y.product.id===g.id);if(l)l.users[v(g.product.id)].quantity++;else{let y=o.dataUser();e.value.push({product:g,users:[{name:y.name,phone:y.phone,quantity:1,date:new Date().toLocaleDateString(),inDBCart:y.isAuthorized}]}),l=e.value[e.value.length-1]}U("Товар добавлен в корзину!"),$(l,"add")}function r(g){console.log("addToCartFromBD");let l=o.dataUser();g.forEach(f=>{console.log(f);const b=e.value.find(C=>C.product.id===f.product.id);if(!b)e.value.push(f);else{let C=[];for(let M=0;M<f.users.length;M++)M===v(f.product.id)&&l.phone===f.users[M].phone?(b.users[M].inDBCart||(b.users[M].quantity+=f.users[M].quantity,$(b,"add")),b.users[M].inDBCart=!0):v(f.product.id)===-1&&!b.users[M].inDBCart?(b.users[0].name=l.name,b.users[0].phone=l.phone,b.users[0].inDBCart=!0,$(b,"addMore"),C.push(f.users[M])):M<b.users.length&&b.users[M].inDBCart||(C.push(f.users[M]),$(b,"add"));C.forEach(M=>{let S=b.users.find(R=>R.phone===M.phone);S?S.quantity+=M.quantity:b.users.push(M)})}});let y=[];e.value.forEach(f=>{g.find(b=>b.product.id===f.product.id)||(f.users[0].name=l.name,f.users[0].phone=l.phone,f.users[0].inDBCart=!0,y.push(f))}),y.length>0&&F.post(route("save.cart",{products:y}))}function v(g){let l=o.dataUser();return console.log(l),e.value.find(f=>f.product.id===g).users.findIndex(f=>f.phone===l.phone)}function p(g,l=v(g)){let y=e.value.find(f=>f.product.id===g);if(l===-1){let f=o.dataUser();y.users.push({name:f.name,phone:f.phone,quantity:1,date:new Date().toLocaleDateString(),inDBCart:f.isAuthorized})}else y.users[l].quantity++;U("Товар добавлен в корзину!"),$(y,"inc")}function _(g,l=v(g)){if(l===-1){j.getOrCreateInstance(document.getElementById("changeUserCart")).show();return}let y=e.value.find(f=>f.product.id===g);y.users[l].quantity>1?(y.users[l].quantity--,U("Лишний товар убран из корзины!"),$(y,"dec")):l===v(g)&&y.users[l].quantity<=1&&y.users.length>1?(y.users.splice(l,1),U("Лишний товар убран из корзины!"),$(y,"dec")):E(g,l)}function E(g,l=v(g)){if(l===-1){j.getOrCreateInstance(document.getElementById("changeUserCart")).show();return}let y=e.value.find(b=>b.product.id===g),f=e.value.indexOf(y);l===v(g)||y.users.length===1?($(e.value[f],"delete"),e.value.splice(f,1)):(y.users.splice(l,1),$(e.value[f],"dec")),U("Лишний товар убран из корзины!")}async function x(){e.value=[],o.dataUser().isAuthorized&&await F.post(route("clear.cart")).catch(l=>{l.response.status===403&&o.getUser()})}async function $(g,l){o.dataUser().isAuthorized&&await F.post(route("change.cart",{product:g,action:l})).catch(f=>{f.response.status===403&&o.getUser()})}return{items:e,getProductById:s,getTotalCount:a,getTotalPrice:n,getTotalWeight:c,inCart:u,addToCart:k,incQuantity:p,decQuantity:_,removeProduct:E,clearCart:x,addToCartFromBD:r}}),At={class:"d-flex justify-content-center"},Tt={class:"group-btn-counter gap-3"},Ut=["name"],Lt=t("span",null,[t("i",{class:"fas fa-trash"})],-1),Bt=[Lt],jt=["name"],Dt=["innerHTML"],zt=["name"],Nt=t("span",null,"+",-1),qt=[Nt],Ft=["name","data-bs-content","disabled"],Jt={class:"fw-bolder"},Wt=["name","disabled"],Qt={__name:"ProductControls",props:{product:{type:Object,default:{}}},setup(e){const s=e,o=P(!1),a=P(new Date().getDay()),n=de("inModal",!1),c=Z(),{items:u}=B(c),h=v=>{let p=new Date;return p.setDate(p.getDate()+7-p.getDay()+v),p.getDate()+"."+(p.getMonth()+1)+"."+p.getFullYear()},k=()=>u.value.filter(p=>p.product.addition===0).length>0||s.product.addition===0,r=async v=>{[...document.getElementsByName("btn-popover-"+v)].forEach(p=>X.getOrCreateInstance(p).dispose()),await oe(),[...document.getElementsByName("btn-popover-"+v)].forEach(p=>X.getOrCreateInstance(p))};return(v,p)=>(i(),d("div",At,[m(c).inCart(e.product.id)>0?(i(),d("div",{key:0,class:"cnt-container",onMouseenter:p[4]||(p[4]=_=>o.value=!0),onMouseleave:p[5]||(p[5]=_=>o.value=!1)},[t("div",Tt,[t("button",{class:"btn btn-danger btn-coutner me-3",name:"btn-popover-"+e.product.id,"data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"bottom","data-bs-content":"Убрать весь продукт из корзины",onClick:p[0]||(p[0]=_=>{m(c).removeProduct(e.product.id),r(e.product.id)})},Bt,8,Ut),t("button",{class:"btn btn-danger btn-coutner",name:"btn-popover-"+e.product.id,onClick:p[1]||(p[1]=_=>{m(c).decQuantity(e.product.id),r(e.product.id)}),"data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"bottom","data-bs-content":"Убрать порцию из корзины"}," - ",8,jt)]),t("p",{innerHTML:m(c).inCart(e.product.id),class:D(m(n)?"text-dark":"text-white")},null,10,Dt),t("button",{class:"btn btn-danger btn-coutner",name:"btn-popover-"+e.product.id,onClick:p[2]||(p[2]=_=>{m(c).incQuantity(e.product.id),r(e.product.id)}),"data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"bottom","data-bs-content":"Добавить еще порцию в корзину"},qt,8,zt),o.value?(i(),d("div",{key:0,class:"btn btn-success sub-btn z-1",onClick:p[3]||(p[3]=_=>v.openCart())},"Оформить")):w("",!0)],32)):w("",!0),!(a.value<e.product.day_index)&&m(c).inCart(e.product.id)===0?(i(),d("button",{key:1,class:"btn btn-danger w-100 text-uppercase mt-2 p-3",name:"btn-popover-"+e.product.id,"data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"bottom","data-bs-content":"Добавить товар в корзину - "+h(e.product.day_index),onClick:p[6]||(p[6]=_=>{m(c).addToCart(e.product),r(e.product.id)}),disabled:!k()},[A("В КОРЗИНУ "),t("span",Jt,O(h(e.product.day_index)),1)],8,Ft)):w("",!0),a.value<e.product.day_index&&m(c).inCart(e.product.id)===0?(i(),d("button",{key:2,class:"btn btn-success w-100 text-uppercase mt-2 p-3 custom-btn-color-success",name:"btn-popover-"+e.product.id,"data-bs-trigger":"hover","data-bs-toggle":"popover","data-bs-placement":"bottom","data-bs-content":"Добавить товар в корзину",onClick:p[7]||(p[7]=_=>{m(c).addToCart(e.product),r(e.product.id)}),disabled:!k()}," В КОРЗИНУ ",8,Wt)):w("",!0)]))}},Xt=["alt","data-bs-target"],Ht={key:0,class:"week-label"},Kt={__name:"ProductCard",props:{product:{type:Object,default:{}},week:{type:Boolean,default:!1}},setup(e){const s=async o=>{[...document.getElementsByName("btn-popover-"+o)].forEach(a=>X.getOrCreateInstance(a).dispose()),await oe(),[...document.getElementsByName("btn-popover-"+o)].forEach(a=>X.getOrCreateInstance(a))};return(o,a)=>{const n=me("lazy");return i(),d("div",{class:D(["day-item",e.week?"week-product":""])},[t("h3",null,O(e.product.title),1),Q(t("img",{alt:e.product.title,class:"w-100","data-bs-toggle":"modal","data-bs-target":"#modal-"+e.product.id,onClick:a[0]||(a[0]=c=>s(e.product.id))},null,8,Xt),[[n,e.product.image]]),I(Qt,{product:e.product},null,8,["product"]),e.product.is_week?(i(),d("div",Ht,"Бесплатная доставка")):w("",!0)],2)}}};/*! maska v2.1.9 | (c) Alexander Shabunevich | Released under the MIT license */var Gt=Object.defineProperty,Zt=(e,s,o)=>s in e?Gt(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o,Y=(e,s,o)=>(Zt(e,typeof s!="symbol"?s+"":s,o),o);const ve={"#":{pattern:/[0-9]/},"@":{pattern:/[a-zA-Z]/},"*":{pattern:/[a-zA-Z0-9]/}};class fe{constructor(s={}){Y(this,"opts",{}),Y(this,"memo",new Map);const o={...s};if(o.tokens!=null){o.tokens=o.tokensReplace?{...o.tokens}:{...ve,...o.tokens};for(const a of Object.values(o.tokens))typeof a.pattern=="string"&&(a.pattern=new RegExp(a.pattern))}else o.tokens=ve;Array.isArray(o.mask)&&(o.mask.length>1?o.mask=[...o.mask].sort((a,n)=>a.length-n.length):o.mask=o.mask[0]??""),o.mask===""&&(o.mask=null),this.opts=o}masked(s){return this.process(s,this.findMask(s))}unmasked(s){return this.process(s,this.findMask(s),!1)}isEager(){return this.opts.eager===!0}isReversed(){return this.opts.reversed===!0}completed(s){const o=this.findMask(s);if(this.opts.mask==null||o==null)return!1;const a=this.process(s,o).length;return typeof this.opts.mask=="string"?a>=this.opts.mask.length:typeof this.opts.mask=="function"?a>=o.length:this.opts.mask.filter(n=>a>=n.length).length===this.opts.mask.length}findMask(s){const o=this.opts.mask;if(o==null)return null;if(typeof o=="string")return o;if(typeof o=="function")return o(s);const a=this.process(s,o.slice(-1).pop()??"",!1);return o.find(n=>this.process(s,n,!1).length>=a.length)??""}escapeMask(s){const o=[],a=[];return s.split("").forEach((n,c)=>{n==="!"&&s[c-1]!=="!"?a.push(c-a.length):o.push(n)}),{mask:o.join(""),escaped:a}}process(s,o,a=!0){var n;if(o==null)return s;const c=`value=${s},mask=${o},masked=${a?1:0}`;if(this.memo.has(c))return this.memo.get(c);const{mask:u,escaped:h}=this.escapeMask(o),k=[],r=this.opts.tokens!=null?this.opts.tokens:{},v=this.isReversed()?-1:1,p=this.isReversed()?"unshift":"push",_=this.isReversed()?0:u.length-1,E=this.isReversed()?()=>l>-1&&y>-1:()=>l<u.length&&y<s.length,x=f=>!this.isReversed()&&f<=_||this.isReversed()&&f>=_;let $,g=-1,l=this.isReversed()?u.length-1:0,y=this.isReversed()?s.length-1:0;for(;E();){const f=u.charAt(l),b=r[f],C=(b==null?void 0:b.transform)!=null?b.transform(s.charAt(y)):s.charAt(y);if(!h.includes(l)&&b!=null){if(C.match(b.pattern)!=null)k[p](C),b.repeated?(g===-1?g=l:l===_&&l!==g&&(l=g-v),_===g&&(l-=v)):b.multiple&&(l-=v),l+=v;else if(b.multiple){const M=((n=k[y-v])==null?void 0:n.match(b.pattern))!=null,S=u.charAt(l+v);M&&S!==""&&r[S]==null?(l+=v,y-=v):k[p]("")}else C===$?$=void 0:b.optional&&(l+=v,y-=v);y+=v}else a&&!this.isEager()&&k[p](f),C===f&&!this.isEager()?y+=v:$=f,this.isEager()||(l+=v);if(this.isEager())for(;x(l)&&(r[u.charAt(l)]==null||h.includes(l));)a?k[p](u.charAt(l)):u.charAt(l)===s.charAt(y)&&(y+=v),l+=v}return this.memo.set(c,k.join("")),this.memo.get(c)}}const $e=e=>JSON.parse(e.replaceAll("'",'"')),be=(e,s={})=>{const o={...s};return e.dataset.maska!=null&&e.dataset.maska!==""&&(o.mask=Yt(e.dataset.maska)),e.dataset.maskaEager!=null&&(o.eager=ie(e.dataset.maskaEager)),e.dataset.maskaReversed!=null&&(o.reversed=ie(e.dataset.maskaReversed)),e.dataset.maskaTokensReplace!=null&&(o.tokensReplace=ie(e.dataset.maskaTokensReplace)),e.dataset.maskaTokens!=null&&(o.tokens=es(e.dataset.maskaTokens)),o},ie=e=>e!==""?!!JSON.parse(e):!0,Yt=e=>e.startsWith("[")&&e.endsWith("]")?$e(e):e,es=e=>{if(e.startsWith("{")&&e.endsWith("}"))return $e(e);const s={};return e.split("|").forEach(o=>{const a=o.split(":");s[a[0]]={pattern:new RegExp(a[1]),optional:a[2]==="optional",multiple:a[2]==="multiple",repeated:a[2]==="repeated"}}),s};class ts{constructor(s,o={}){Y(this,"items",new Map),Y(this,"beforeinputEvent",a=>{const n=a.target,c=this.items.get(n);c.isEager()&&"inputType"in a&&a.inputType.startsWith("delete")&&c.unmasked(n.value).length<=1&&this.setMaskedValue(n,"")}),Y(this,"inputEvent",a=>{if(a instanceof CustomEvent&&a.type==="input"&&a.detail!=null&&typeof a.detail=="object"&&"masked"in a.detail)return;const n=a.target,c=this.items.get(n),u=n.value,h=n.selectionStart,k=n.selectionEnd;let r=u;if(c.isEager()){const v=c.masked(u),p=c.unmasked(u);p===""&&"data"in a&&a.data!=null?r=a.data:p!==c.unmasked(v)&&(r=p)}if(this.setMaskedValue(n,r),"inputType"in a&&(a.inputType.startsWith("delete")||h!=null&&h<u.length))try{n.setSelectionRange(h,k)}catch{}}),this.options=o,typeof s=="string"?this.init(Array.from(document.querySelectorAll(s)),this.getMaskOpts(o)):this.init("length"in s?Array.from(s):[s],this.getMaskOpts(o))}destroy(){for(const s of this.items.keys())s.removeEventListener("input",this.inputEvent),s.removeEventListener("beforeinput",this.beforeinputEvent);this.items.clear()}needUpdateOptions(s,o){const a=this.items.get(s),n=new fe(be(s,this.getMaskOpts(o)));return JSON.stringify(a.opts)!==JSON.stringify(n.opts)}needUpdateValue(s){const o=s.dataset.maskaValue;return o==null&&s.value!==""||o!=null&&o!==s.value}getMaskOpts(s){const{onMaska:o,preProcess:a,postProcess:n,...c}=s;return c}init(s,o){for(const a of s){const n=new fe(be(a,o));this.items.set(a,n),a.value!==""&&this.setMaskedValue(a,a.value),a.addEventListener("input",this.inputEvent),a.addEventListener("beforeinput",this.beforeinputEvent)}}setMaskedValue(s,o){const a=this.items.get(s);this.options.preProcess!=null&&(o=this.options.preProcess(o));const n=a.masked(o),c=a.unmasked(a.isEager()?n:o),u=a.completed(o),h={masked:n,unmasked:c,completed:u};o=n,this.options.postProcess!=null&&(o=this.options.postProcess(o)),s.value=o,s.dataset.maskaValue=o,this.options.onMaska!=null&&(Array.isArray(this.options.onMaska)?this.options.onMaska.forEach(k=>k(h)):this.options.onMaska(h)),s.dispatchEvent(new CustomEvent("maska",{detail:h})),s.dispatchEvent(new CustomEvent("input",{detail:h}))}}const ce=new WeakMap,ss=e=>{setTimeout(()=>{var s;((s=ce.get(e))==null?void 0:s.needUpdateValue(e))===!0&&e.dispatchEvent(new CustomEvent("input"))})},os=(e,s)=>{const o=e instanceof HTMLInputElement?e:e.querySelector("input"),a={...s.arg};if(o==null)return;ss(o);const n=ce.get(o);if(n!=null){if(!n.needUpdateOptions(o,a))return;n.destroy()}if(s.value!=null){const c=s.value,u=h=>{c.masked=h.masked,c.unmasked=h.unmasked,c.completed=h.completed};a.onMaska=a.onMaska==null?u:Array.isArray(a.onMaska)?[...a.onMaska,u]:[a.onMaska,u]}ce.set(o,new ts(o,a))},as=["type","placeholder","value","data-maska"],ns={class:"invalid-feedback"},q={__name:"TextInput",props:{modelValue:{type:String,required:!0},placeholder:{type:String,required:!0},type:{type:String,default:"text"},mask:{type:String,default:null},errors:{type:Array,default:[]},blur:{default:null}},emits:["update:modelValue"],setup(e){return(s,o)=>(i(),d(V,null,[Q(t("input",{type:e.type,class:D(["form-control w-100 mt-2 mb-0 px-4 py-3",[e.errors.length>0?"is-invalid":"",e.errors.length===0&&e.modelValue!==""&&e.modelValue!==null?"is-valid":""]]),placeholder:e.placeholder,value:e.modelValue,"data-maska":e.mask,onInput:o[0]||(o[0]=a=>s.$emit("update:modelValue",a.target.value)),onBlur:o[1]||(o[1]=(...a)=>e.blur&&e.blur(...a))},null,42,as),[[m(os)]]),e.errors.length>0?(i(!0),d(V,{key:0},z(e.errors,a=>(i(),d("div",ns,O(a),1))),256)):w("",!0)],64))}};const rs=["onClick"],ls={__name:"AddressesSelect",props:{formAddress:{type:String,default:null},errors:{type:Array,required:!0},blur:{type:Function,required:!0},clearMessage:{type:Function,required:!0}},emits:["update:formAddress","option:selected","search:blur"],setup(e,{emit:s}){const o=e,{user:a}=B(G()),n=P(null),c=P(!0),u=P("");ee(n,()=>{s("update:formAddress",n.value)});const h=_=>{_!==null&&_!==""&&(n.value=_,o.clearMessage())},k=()=>{r(!0),o.blur()},r=(_=!1)=>{!a.value.addresses.some(E=>E===n.value)&&n.value!==null&&n.value!==""&&a.value.addresses.push(n.value),_&&s("option:selected",n.value)},v=async _=>{c.value=!1,n.value=null,a.value.addresses.splice(a.value.addresses.indexOf(_),1),u.value=_},p=_=>{_!==u.value?(n.value=_,c.value||document.getElementsByClassName("vs__search")[0].blur(),c.value=!0):(u.value="",n.value=null)};return(_,E)=>{const x=se("v-select");return i(),J(x,{modelValue:n.value,"onUpdate:modelValue":E[0]||(E[0]=$=>n.value=$),options:m(a).addresses,taggable:"",onSearch:h,"onSearch:blur":k,onChange:r,closeOnSelect:c.value,"onOption:selected":p,placeholder:"Адрес доставки",class:D(["form-control",[e.errors.length>0?"is-invalid":"",e.errors.length===0&&n.value!==null?"is-valid":""]])},{option:L(({label:$})=>[m(a).addresses.indexOf($)!==-1?(i(),d("button",{key:0,type:"button",class:"btn-close position-relative z-3","aria-label":"Close",onClick:g=>v($)},null,8,rs)):w("",!0),A(" "+O($),1)]),_:1},8,["modelValue","options","closeOnSelect","class"])}}},is=["onSubmit"],ds={key:0,class:"text-success mt-2"},us={class:"invalid-feedback"},cs={class:"summary"},ps={key:0},ms=["disabled"],hs=t("p",{class:"end-info"},"После оформления заявки вам будет предложен для скачивания чек с подробным описанием заказа, его номером и промокодом для лотереи",-1),gs=t("div",{class:"row justify-content-center"},[t("p",null,"Хотите ли вы стать нашим клиентом?")],-1),vs={class:"modal-footer"},fs=t("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Нет",-1),bs=t("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Отмена",-1),_s={__name:"OrderForm",props:{modelValue:{type:String}},emits:["update:modelValue"],setup(e,{emit:s}){const o=Z(),{items:a,getTotalPrice:n,getTotalWeight:c}=B(o),u=G(),{user:h}=B(u),k=P(!1),r=H({name:"",address:null,phone:"",message:"",delivery_price:null,delivery_range:null,total_weight:0,total_price:0,total_count:0,addresses:[],code:null,manager_phone:null}),v=P(!1),p=P(null),_=P([]),E=P(60);ae(()=>{r.name=h.value.name,r.phone=h.value.phone});const x=async()=>{await oe(),p.value="Мы ищем ваш Адрес, пожалуйста, ожидайте!",await axios.post(route("delivery.range"),{address:r.address}).then(f=>{p.value="Цена доставки к Вам "+f.data.price+" руб.",v.value=!0,r.delivery_price=f.data.price,r.delivery_range=f.data.range})},$=()=>{r.products=a.value,r.addresses=h.value.addresses,h.value.name=r.name,h.value.phone=r.phone,axios.post(route("order"),r,{responseType:"blob"}).then(f=>{j.getOrCreateInstance(document.getElementById("confirmOrder")).hide();let b=window.URL.createObjectURL(new Blob([f.data])),C=document.createElement("a");C.href=b,C.setAttribute("download","report.pdf"),document.body.appendChild(C),C.click(),U("Ваш заказ успешно отправлен! Ожидайте звонка оператора!"),a.value=[],k.value&&u.login({phone:r.phone,password:r.phone}),!h.value.isAuthorized&&!k.value&&j.getOrCreateInstance(document.getElementById("register")).show(),s("update:modelValue",!1),E.value=60}).catch(async f=>{if(f.response.status===422){const b=JSON.parse(await f.response.data.text());_.value=b.errors}f.response.status===406&&(k.value=!0,j.getOrCreateInstance(document.getElementById("confirmOrder")).show(),await l()),f.response.status===409&&(j.getOrCreateInstance(document.getElementById("confirmOrder")).hide(),a.value=[],k.value&&u.login({phone:r.phone,password:r.phone}),!h.value.isAuthorized&&!k.value&&j.getOrCreateInstance(document.getElementById("register")).show(),s("update:modelValue",!1),E.value=60,U("Ваш заказ успешно отправлен менеджеру!"))})},g=()=>{p.value=null},l=async()=>{await setTimeout(()=>{E.value!==0&&(E.value--,l())},1e3)},y=()=>{u.sendCode(),E.value=60};return(f,b)=>(i(),d(V,null,[t("form",{onSubmit:We($,["prevent"]),class:"order-form w-100"},[t("button",{class:"hider",onClick:b[0]||(b[0]=C=>f.$emit("update:modelValue",!1))},"Скрыть"),I(q,{errors:_.value.hasOwnProperty("name")?_.value.name:[],placeholder:"Ваше имя",modelValue:r.name,"onUpdate:modelValue":b[1]||(b[1]=C=>r.name=C)},null,8,["errors","modelValue"]),I(q,{errors:_.value.hasOwnProperty("phone")?_.value.phone:[],placeholder:"Ваш номер телефона",modelValue:r.phone,"onUpdate:modelValue":b[2]||(b[2]=C=>r.phone=C),mask:"+7 (###) ###-##-##"},null,8,["errors","modelValue"]),p.value&&r.address!==null?(i(),d("p",ds,O(p.value),1)):w("",!0),I(ls,{formAddress:r.address,"onUpdate:formAddress":b[3]||(b[3]=C=>r.address=C),errors:_.value.hasOwnProperty("address")?_.value.address:[],blur:x,clearMessage:g},null,8,["formAddress","errors"]),"address"in _.value&&_.value.address.length>0?(i(!0),d(V,{key:1},z(_.value.address,C=>(i(),d("div",us,O(C),1))),256)):w("",!0),I(q,{errors:_.value.hasOwnProperty("manager_phone")?_.value.manager_phone:[],placeholder:"Номер телефона менеджера",modelValue:r.manager_phone,"onUpdate:modelValue":b[4]||(b[4]=C=>r.manager_phone=C),mask:"+7 (###) ###-##-##"},null,8,["errors","modelValue"]),Q(t("textarea",{class:D(["form-control mb-0 mt-2",[_.value.hasOwnProperty("message")&&_.value.message.length>0?"is-invalid":"",!_.value.hasOwnProperty("message")&&r.message!==""?"is-valid":""]]),placeholder:"Текстовое сообщение","onUpdate:modelValue":b[5]||(b[5]=C=>r.message=C)},null,2),[[Je,r.message]]),t("ul",cs,[t("li",null,[t("p",null,[A("Цена заказа: "),t("span",null,O(m(n))+" руб",1)])]),t("li",null,[t("p",null,[A("Масса заказа: "),t("span",null,O(m(c))+" гр",1)])]),r.delivery_price?(i(),d("li",ps,[t("p",null,[A("Примерная цена доставки: "),t("span",null,O(r.delivery_price)+" руб.",1)])])):w("",!0)]),t("button",{class:"btn btn-success w-100 p-3 text-uppercase font-weight-bold",disabled:!v.value&&r.manager_phone===null}," Отправить заявку ",8,ms),hs],40,is),I(N,{id:"register",header:!1,footer:!1},{body:L(()=>[gs]),footer:L(()=>[t("div",vs,[fs,t("button",{type:"button",class:"btn btn-success",onClick:b[6]||(b[6]=(...C)=>m(u).register&&m(u).register(...C)),"data-bs-dismiss":"modal"},"Да ")])]),_:1}),I(N,{id:"confirmOrder",title:"Подтвердите Ваш заказ кодом из смс",footer:!1},{body:L(()=>[I(q,{errors:_.value.hasOwnProperty("code")?_.value.code:[],placeholder:"Введите код подтверждения",modelValue:r.code,"onUpdate:modelValue":b[7]||(b[7]=C=>r.code=C),mask:"####"},null,8,["errors","modelValue"]),t("button",{type:"button",class:D(["btn btn-link text-decoration-none",E.value!==0?"disabled":"text-success"]),onClick:b[8]||(b[8]=C=>E.value===0?y():null)},"Отправить код повторно"+O(E.value!==0?" через "+E.value:""),3)]),footer:L(()=>[t("div",{class:"modal-footer"},[bs,t("button",{type:"button",class:"btn btn-success",onClick:$},"Подтвердить")])]),_:1})],64))}},ys={class:"modal-header"},ks=t("h5",{class:"modal-title"},"Отчет по пользователям",-1),$s=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ws={class:"table-responsive"},Cs={class:"table table-hover"},Es=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"Имя пользователя"),t("th",{scope:"col"},"Телефон пользователя"),t("th",{scope:"col"},"Количество порций"),t("th",{scope:"col"},"Дата добавления"),t("th",{scope:"col"},"Действия")])],-1),Os={class:"d-flex gap-3"},Rs={class:"group-btn-counter gap-1"},Is=["onClick"],xs=["onClick"],Ss=t("span",null,"+",-1),Ms=[Ss],we={__name:"UserCartModal",setup(e){const s=Z(),{items:o}=B(s),a=he(),{foodParts:n}=B(a),c=async()=>{await axios.get(route("print.report"),{responseType:"blob"}).then(u=>{let h=window.URL.createObjectURL(new Blob([u.data])),k=document.createElement("a");k.href=h,k.setAttribute("download","report.pdf"),document.body.appendChild(k),k.click()}).catch(async u=>{u.response.status===403&&U("Для печати отчета необходима авторизация!","error")})};return(u,h)=>(i(),J(N,{id:"changeUserCart",header:!1,footer:!1,class_size:"modal-lg"},{header:L(()=>[t("div",ys,[W(u.$slots,"title",{},()=>[ks]),t("button",{class:"btn btn-secondary btn-link",onClick:h[0]||(h[0]=k=>c())},"Распечатать"),$s])]),body:L(()=>[m(o).length>0?(i(!0),d(V,{key:0},z(m(o),k=>(i(),d(V,null,[t("p",null,[t("strong",null,O(m(n).find(r=>r.partId===k.product.partId).title),1),A(". "+O(k.product.title),1)]),t("div",ws,[t("table",Cs,[Es,t("tbody",null,[(i(!0),d(V,null,z(k.users,(r,v)=>(i(),d("tr",null,[t("td",null,O(r.name),1),t("td",null,O(r.phone),1),t("td",null,O(r.quantity),1),t("td",null,O(r.date),1),t("td",null,[t("div",Os,[t("div",Rs,[t("button",{class:"btn btn-danger btn-coutner",onClick:p=>m(s).decQuantity(k.product.id,v)}," - ",8,Is),t("button",{class:"btn btn-danger btn-coutner",onClick:p=>m(s).incQuantity(k.product.id,v)},Ms,8,xs)])])])]))),256))])])])],64))),256)):w("",!0)]),_:3}))}},Ps={class:"cart-modal"},Vs={class:"cart-modal-inner"},As={key:0,class:"btn btn-link fs-2","data-bs-toggle":"modal","data-bs-target":"#changeUserCart"},Ts=t("i",{class:"far fa-circle-info text-danger"},null,-1),Us=[Ts],Ls={class:"day-item-wrapper list-group-numbered"},Bs={key:1},js=t("img",{src:"/images/logo_obed_go.jpg",class:"img-fluid",alt:""},null,-1),Ds=t("h3",{class:"text-uppercase text-center"},"В корзине пусто...",-1),zs=[js,Ds],Ns={key:0,class:"custom-modal-footer"},qs=["disabled"],Fs={__name:"CartModal",setup(e){const s=Z(),{items:o}=B(s),a=G(),{user:n}=B(a),c=H({suppressScrollX:!0,suppressScrollY:!1}),u=de("ready_to_order"),h=de("is_cart_open");ue("inModal",!0);const k=()=>o.value.filter(p=>p.product.addition===0).length>0,r=K(()=>o.value.find(v=>!!v.users.find(_=>_.phone!==n.value.phone))!==void 0);return(v,p)=>{const _=se("perfect-scrollbar");return i(),d("div",Ps,[t("div",Vs,[t("div",{class:D(["custom-modal-header",m(r)?"justify-content-between":""])},[m(r)?(i(),d("button",As,Us)):w("",!0),t("button",{class:"btn btn-link",onClick:p[0]||(p[0]=E=>h.value=!1)},"Закрыть")],2),I(_,{class:"scroll-area scroll-area-bottom ms-0 ps-0",options:c,tag:"ul"},{default:L(()=>[m(s).getTotalCount>0?(i(!0),d(V,{key:0},z(m(o),E=>(i(),d("li",Ls,[I(Kt,{product:E.product},null,8,["product"]),I(we,{productId:E.product.id},null,8,["productId"])]))),256)):w("",!0),m(s).getTotalCount===0?(i(),d("li",Bs,zs)):w("",!0)]),_:1},8,["options"]),m(s).getTotalCount>0?(i(),d("div",Ns,[m(u)?w("",!0):(i(),d("button",{key:0,class:"btn btn-danger w-100 p-3 text-uppercase fw-bold",disabled:!k(),onClick:p[1]||(p[1]=E=>u.value=!0)},[A("Оформить "),t("strong",null,O(m(s).getTotalPrice)+" руб",1)],8,qs)),m(u)?w("",!0):(i(),d("button",{key:1,class:"btn btn-outline-danger mt-2 w-100 p-3 text-uppercase fw-bold",onClick:p[2]||(p[2]=(...E)=>m(s).clearCart&&m(s).clearCart(...E))},"Очистить ")),m(u)?(i(),J(_s,{key:2,modelValue:m(u),"onUpdate:modelValue":p[3]||(p[3]=E=>Qe(u)?u.value=E:null)},null,8,["modelValue"])):w("",!0)])):w("",!0)]),t("div",{class:"cart-shadow",onClick:p[4]||(p[4]=E=>h.value=!1)})])}}},Js=["id"],Ws={key:0,class:"carousel-indicators"},Qs=["data-bs-target","data-bs-slide-to","aria-current","aria-label"],Xs={class:"carousel-inner"},Hs=["src"],Ks=["data-bs-target"],Gs=t("span",{class:"carousel-control-prev-icon","aria-hidden":"true"},null,-1),Zs=t("span",{class:"visually-hidden"},"Previous",-1),Ys=[Gs,Zs],eo=["data-bs-target"],to=t("span",{class:"carousel-control-next-icon","aria-hidden":"true"},null,-1),so=t("span",{class:"visually-hidden"},"Next",-1),oo=[to,so],ao={__name:"Carousel",props:{id:{type:String,default:"carousel"},hasIndicators:{type:Boolean,default:!0},hasControls:{type:Boolean,default:!0},items:{type:Array,default:[]}},setup(e){return(s,o)=>(i(),d("div",{id:e.id,class:"carousel slide carousel-fade","data-bs-ride":"carousel"},[e.hasIndicators?(i(),d("div",Ws,[(i(!0),d(V,null,z(e.items,(a,n)=>(i(),d("button",{type:"button","data-bs-target":"#"+e.id,"data-bs-slide-to":n,class:D(n===0?"active":""),"aria-current":n===0?"active":"","aria-label":a},null,10,Qs))),256))])):w("",!0),t("div",Xs,[(i(!0),d(V,null,z(e.items,(a,n)=>(i(),d("div",{class:D(["carousel-item",n===0?"active":""])},[t("img",{class:"d-block w-100",src:a,alt:""},null,8,Hs)],2))),256))]),e.hasControls?(i(),d(V,{key:1},[t("button",{class:"carousel-control-prev",type:"button","data-bs-target":"#"+e.id,"data-bs-slide":"prev"},Ys,8,Ks),t("button",{class:"carousel-control-next",type:"button","data-bs-target":"#"+e.id,"data-bs-slide":"next"},oo,8,eo)],64)):w("",!0)],8,Js))}},ge=te("lottery",()=>{const e=P([]),s=P(null),o=P({});return{lotteries:e,lottery_id:s,lotteryItem:o,loadLotteries:async()=>{await axios.get(route("lotteries")).then(c=>{e.value=c.data})},loadLottery:async()=>{await axios.get(route("lottery",s.value)).then(c=>{o.value=c.data})}}}),no={class:"row mt-2 mb-2 d-flex justify-content-center flex-wrap"},ro={class:"col-md-6 col-lg-4 col-12"},lo={class:"lottery-slide mb-3"},io={alt:""},uo={class:"inf"},co={class:"progress",style:{height:"30px"}},po=["onClick"],mo={__name:"Lotteries",setup(e){const s=ge(),{lotteries:o,lottery_id:a}=B(s);return ae(()=>{s.loadLotteries()}),(n,c)=>{const u=me("lazy");return i(),d("div",no,[(i(!0),d(V,null,z(m(o),h=>(i(),d("div",ro,[t("div",lo,[Q(t("img",io,null,512),[[u,h.image]]),t("p",uo,[A("Мест: "),t("strong",null,O(h.place_count-h.free_place_count)+" / "+O(h.place_count),1)]),t("div",co,[t("div",{class:"progress-bar progress-bar-striped progress-bar-animated bg-success",role:"progressbar",style:ye("width: "+(h.place_count-h.free_place_count)/h.place_count*100+"%")},null,4)]),t("button",{class:"btn btn-danger mt-2 w-100",onClick:k=>a.value=h.id},"Участвовать",8,po)])]))),256))])}}},ho={key:0,class:"row"},go={class:"col-12"},vo={class:"text-danger"},fo={key:0,class:"badge bg-success"},bo={key:1,class:"badge bg-danger"},_o={key:2},yo={key:3,class:"badge bg-danger"},ko={class:"progress",style:{height:"30px"}},$o={class:"col-sm-4 col-md-3 col-6 lottery-item-wrapper",role:"button"},wo=["onClick"],Co={key:0,alt:""},Eo={key:1,alt:""},Oo={key:1,class:"row"},Ro={class:"col-12 d-flex justify-content-center align-items-center"},Io={class:"img-fluid",alt:""},xo={class:"row d-flex justify-content-center"},So={class:"col-12"},Mo=t("h4",{class:"col-12 mb-2 mt-2"},[A("Для получение "),t("span",{class:"text-danger fw-bolder"},"оповещения"),A(" о выигрыше Вам необходимо сообщить нам свой номер "),t("span",{class:"text-danger fw-bolder"},"телефона"),A(" и "),t("span",{class:"text-danger fw-bolder"},"электронную почту")],-1),Po={class:"col-12"},Vo={class:"col-12"},Ao={class:"col-12"},To={class:"col-12 col-sm-6"},Uo={class:"row justify-content-center"},Lo={__name:"LotteryGame",setup(e){const s=ge(),{lotteryItem:o,lottery_id:a}=B(s),n=G(),{user:c}=B(n),u=P(null),h=P([]),k={name:"",email:"",phone:"",code:"",lottery_id:a.value,selected_place:null},r=H({...k});ae(()=>{s.loadLottery(),Echo.channel(`lottery.${r.lottery_id}`).listen("ChangeLotteryEvent",()=>{s.loadLottery()}),v()});const v=()=>{Object.assign(r,k),Object.assign(r,{phone:c.value.phone,name:c.value.name}),h.value=[]},p=x=>{let $=o.value.occupied_places;return $.length===0?!1:$.find(g=>g===x)!=null},_=x=>{if(p(x)){U("Данный слот уже кем-то занят! Попробуйте занять другой!","error");return}r.selected_place=x,j.getOrCreateInstance(document.getElementById("personal-info")).show()},E=()=>{axios.post(route("lottery.pick"),r).then(x=>{u.value=x.data.current_slot_count===0?null:x.data.current_slot_count,U("Спасибо! Слот успешно занят вами!"),j.getOrCreateInstance(document.getElementById("personal-info")).hide(),v(),u.value!==null&&j.getOrCreateInstance(document.getElementById("accept-lottery")).show()}).catch(x=>{x.response.data.errors&&x.response.data.errors.lottery_id?(U(x.response.data.errors.lottery_id[0],"error"),j.getOrCreateInstance(document.getElementById("personal-info")).hide(),o.value={}):x.response.data.errors&&x.response.data.errors.selected_place?(U(x.response.data.errors.selected_place[0],"error"),j.getOrCreateInstance(document.getElementById("personal-info")).hide(),s.loadLottery()):h.value=x.response.data.errors})};return(x,$)=>{const g=me("lazy");return i(),d(V,null,[m(o)?(i(),d("div",ho,[t("div",go,[t("h2",vo,O(m(o).title),1),m(o).is_active?(i(),d("div",fo,"Лотерея активна (до "+O(m(o).date_end)+")",1)):(i(),d("div",bo,"Лотерея не активна")),u.value?(i(),d("p",_o,[A("Доступное число активаций "),t("strong",null,O(u.value),1)])):w("",!0),m(o).is_complete?(i(),d("div",yo,"Лотерея окончена")):w("",!0),t("p",null,O(m(o).description),1),t("div",ko,[t("div",{class:"progress-bar progress-bar-striped progress-bar-animated bg-success",role:"progressbar",style:ye("width: "+(m(o).place_count-m(o).free_place_count)/m(o).place_count*100+"%")},null,4)])]),(i(!0),d(V,null,z(m(o).place_count,l=>(i(),d("div",$o,[t("div",{class:"lottery-item",onClick:y=>_(l)},[p(l)?Q((i(),d("img",Eo,null,512)),[[g,"/images/logo_obed_go_occuped.jpg"]]):Q((i(),d("img",Co,null,512)),[[g,"/images/logo_obed_go.jpg"]]),t("p",null,"#"+O(l),1)],8,wo)]))),256))])):(i(),d("div",Oo,[t("div",Ro,[Q(t("img",Io,null,512),[[g,"/images/logo_obed_go.jpg"]])])])),I(N,{id:"personal-info",title:"Участие в розыгрыше","clear-function":v},{body:L(()=>[t("form",xo,[t("div",So,[I(q,{errors:h.value.code,placeholder:"Промокод",modelValue:r.code,"onUpdate:modelValue":$[0]||($[0]=l=>r.code=l)},null,8,["errors","modelValue"])]),Mo,t("div",Po,[I(q,{errors:h.value.name,placeholder:"Ваше имя",modelValue:r.name,"onUpdate:modelValue":$[1]||($[1]=l=>r.name=l)},null,8,["errors","modelValue"])]),t("div",Vo,[I(q,{errors:h.value.phone,placeholder:"Ваш номер телефона",modelValue:r.phone,"onUpdate:modelValue":$[2]||($[2]=l=>r.phone=l),mask:"+7 (###) ###-##-##"},null,8,["errors","modelValue"])]),t("div",Ao,[I(q,{errors:h.value.email,placeholder:"Ваша почта",modelValue:r.email,"onUpdate:modelValue":$[3]||($[3]=l=>r.email=l),type:"email"},null,8,["errors","modelValue"])]),t("div",To,[t("button",{type:"button",class:"btn btn-outline-success w-100 mt-3",onClick:$[4]||($[4]=l=>E())},"Занять место")])])]),_:1}),I(N,{id:"accept-lottery",header:!1,footer:!0},{body:L(()=>[t("div",Uo,[t("p",null,[A("Доступное число активаций "),t("strong",null,O(u.value),1)])])]),_:1})],64)}}},Bo={class:"wrapper obedygo"},jo={class:"container-fluid d-flex align-items-center flex-wrap",style:{"min-height":"100vh",padding:"70px 10px 70px 10px"}},Do=t("h6",{class:"col-8 px-3"},[A("Полное меню на неделю можно глянуть "),t("a",{href:"#",class:"text-danger font-weight-bold","data-bs-toggle":"modal","data-bs-target":"#menu"},"ТУТ")],-1),zo={key:0,class:"mt-2"},No={key:2,class:"w-100"},qo={key:3,class:"w-100"},Fo={key:5,class:"w-100 row m-0 d-flex flex-wrap justify-content-center mb-5"},Jo=t("div",{class:"col-lg-6 col-md-6 col-sm-8 col-12"},[t("h4",{class:"text-white"},[t("em",null,[A("В данный момент этот раздел не доступен, но это не должно Вас огорчать - теперь вы можете "),t("span",{class:"text-danger"},"оформить заказ голосом!")])])],-1),Wo=[Jo],Qo={key:6,class:"w-100"},Xo={key:8,class:"cart-container d-sm-block d-none"},Ho={key:0,class:"cart-icon login","data-bs-toggle":"modal","data-bs-target":"#login"},Ko={key:0},Go=t("div",{class:"cart-icon about","data-bs-toggle":"modal","data-bs-target":"#about"},"О нас",-1),Zo=t("div",{class:"cart-icon callback","data-bs-toggle":"modal","data-bs-target":"#callback"},"Напиши нам",-1),Yo=t("div",{class:"cart-icon delivery","data-bs-toggle":"modal","data-bs-target":"#delivery"},"Доставка",-1),ea={key:0,class:"badge badge-danger"},ta={class:"bottom_menu"},sa=["onClick"],oa=t("li",{class:"hr"},null,-1),aa={key:0,class:"badge badge-danger"},na=t("li",{"data-bs-toggle":"modal","data-bs-target":"#about"},"О нас",-1),ra=t("li",{"data-bs-toggle":"modal","data-bs-target":"#callback"},"Напиши нам",-1),la=t("li",{"data-bs-toggle":"modal","data-bs-target":"#delivery"},"Доставка",-1),ia=t("img",{src:"/images/logo_obed_go.jpg",class:"img-fluid",alt:"О нас"},null,-1),da=t("p",{class:"color--black text-justify"},'Обеды GO - это доставка вкуснейших обедов, приготовленных с любовью. Здесь каждый найдет для себя то, что ищет - домашние блюда, блюда "премиум", здоровая еда, стритфуд и многое другое. Вы можете выбрать для себя сформированное ежедневное комплексное меню или же собрать свой рацион по вкусу.',-1),ua=t("ul",{class:"about-list"},[t("li",null,"Доставка осуществляется с 12:00 до 14:00 только в будние дни."),t("li",null,'Блюда из разделов "стандарт" и "премиум" заказываются ЗА ДЕНЬ. Предзаказ на понедельник также доступен и в выходные дни. '),t("li",null,'Блюда из раздела "экспресс" заказываются и доставляются день в день.'),t("li",null,"Дополнительные блюда заказываются за сутки!")],-1),ca={class:"row"},pa={class:"col-12"},ma={class:"row justify-content-center"},ha=t("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal"},"Отмена",-1),fa={__name:"BaseLayout",setup(e){const s=he(),o=Z(),{foodParts:a,part:n}=B(s),{items:c,getTotalCount:u}=B(o),{lottery_id:h,lotteries:k}=B(ge()),r=G(),{user:v}=B(r),p=P(!1),_=P(!1),E=P(!1),x={phone:"",password:""},$=H({...x}),g=P([]);ue("ready_to_order",E),ue("is_cart_open",_),ee(n,()=>{s.selectPart()}),ae(()=>{[...document.querySelectorAll('[data-bs-toggle="popover"]')].forEach(S=>X.getOrCreateInstance(S)),l(),window.addEventListener("keyup",y),console.log("base mount"),r.getUser()}),Xe(()=>{window.removeEventListener("keyup",y)});const l=()=>{if(route().current("products")&&n.value===0)switch(route().params.foodPart){case"standard":n.value=1;break;case"express":n.value=2;break;case"premium":n.value=3;break;case"self":n.value=4;break}},y=S=>{switch(S.keyCode){case 27:n.value=0;break;case 37:s.changePosition(!1);break;case 39:s.changePosition();break}},f=async()=>{for(const S of c.value)[...document.getElementsByName("btn-popover-"+S.product.id)].forEach(R=>X.getOrCreateInstance(R).dispose()),await oe(),[...document.getElementsByName("btn-popover-"+S.product.id)].forEach(R=>X.getOrCreateInstance(R))},b=()=>{Object.assign($,x),g.value=[]},C=()=>{r.login($).then(S=>{j.getOrCreateInstance(document.getElementById("login")).hide(),b()},S=>{S.hasOwnProperty("response")&&(g.value=S.response.data.errors)})},M=K(()=>c.value.find(S=>!!S.users.find(ne=>ne.phone!==v.value.phone))!==void 0);return ee(M,S=>{S||j.getOrCreateInstance(document.getElementById("changeUserCart")).hide()}),(S,R)=>{const ne=se("notifications");return i(),d("div",Bo,[I(ne,{position:"top left",group:"info"}),t("div",jo,[m(n)===0?W(S.$slots,"content",{key:0}):(i(),J(dt,{key:1})),t("div",{class:D(["w-100 d-flex flex-column align-items-center text-uppercase text-white text-center mt-4",m(n)===0?"mb-5 mt-5":""])},[Do,(i(!0),d(V,null,z(m(a),T=>(i(),d(V,null,[m(n)===T.partId?(i(),d("h1",zo,O(T.title),1)):w("",!0)],64))),256))],2),m(n)===0?(i(),d("div",No)):w("",!0),m(n)===0?(i(),d("div",qo)):w("",!0),m(n)>0&&m(n)<4?W(S.$slots,"content",{key:4}):w("",!0),m(n)===4?(i(),d("div",Fo,Wo)):w("",!0),m(n)===4?(i(),d("div",Qo)):w("",!0),_.value?(i(),J(Fs,{key:7})):w("",!0),_.value?w("",!0):(i(),d("div",Xo,[m(v).isAuthorized?(i(),d("div",{key:1,class:"cart-icon login",onClick:R[0]||(R[0]=T=>m(r).logout())},"Выйти")):(i(),d("div",Ho," Войти ")),t("div",{class:"cart-icon cart",onClick:R[1]||(R[1]=T=>{_.value=!0,f()})},[A("Корзина "),m(u)>0?(i(),d("span",Ko,O(m(u)),1)):w("",!0)]),Go,Zo,Yo,m(k).length>0?(i(),d("div",{key:2,class:"cart-icon lottery","data-bs-toggle":"modal","data-bs-target":"#lottery",onClick:R[2]||(R[2]=T=>h.value=null)},"Акции ")):w("",!0)])),t("ul",{class:"footer-container d-sm-none",onMouseleave:R[7]||(R[7]=T=>p.value=!1)},[p.value?(i(),d(V,{key:1},[t("li",{class:"p-2 text-center",onClick:R[4]||(R[4]=T=>p.value=!1)},"Скрыть меню"),t("ul",ta,[(i(!0),d(V,null,z(m(a),T=>(i(),d("li",{onClick:ga=>n.value=T.partId},O(T.title),9,sa))),256)),oa,t("li",{onClick:R[5]||(R[5]=T=>_.value=!0)},[A(" Корзина "),S.countInCart>0?(i(),d("span",aa,O(S.countInCart),1)):w("",!0)]),na,ra,la,m(k).length>0?(i(),d("li",{key:0,"data-bs-toggle":"modal","data-bs-target":"#lottery",onClick:R[6]||(R[6]=T=>h.value=null)},"Акции ")):w("",!0)])],64)):(i(),d("li",{key:0,class:"p-2 text-center",onClick:R[3]||(R[3]=T=>p.value=!0)},[A("Показать меню "),m(u)>0?(i(),d("span",ea,O(m(u)),1)):w("",!0)]))],32),I(N,{id:"about",title:"О Нас"},{body:L(()=>[ia,da]),_:1}),I(N,{id:"delivery",title:"Условия доставки"},{body:L(()=>[ua]),_:1}),I(N,{id:"callback",title:"Обратная связь"},{body:L(()=>[t("div",ca,[t("div",pa,[I(Vt)])])]),_:1}),I(N,{id:"lottery",class_size:"modal-lg",title:"Розыгрыши и призы","clear-function":b},{body:L(()=>[m(h)?(i(),J(Lo,{key:1})):(i(),J(mo,{key:0}))]),_:1}),I(N,{id:"menu",class_size:"modal-lg",header:!1},{body:L(()=>[I(ao,{id:"carousel-fade",items:["/images/full_1.jpg","/images/full_2.jpg"]},null,8,["items"])]),_:1}),I(N,{id:"login",title:"Войти в аккаунт",footer:!1,"clear-function":b},{body:L(()=>[t("div",ma,[I(q,{errors:g.value.hasOwnProperty("phone")?g.value.phone:[],placeholder:"Ваш номер телефона",modelValue:$.phone,"onUpdate:modelValue":R[8]||(R[8]=T=>$.phone=T),mask:"+7 (###) ###-##-##"},null,8,["errors","modelValue"]),I(q,{errors:g.value.hasOwnProperty("password")?g.value.password:[],placeholder:"Ваш пароль",modelValue:$.password,"onUpdate:modelValue":R[9]||(R[9]=T=>$.password=T),type:"password"},null,8,["errors","modelValue"])])]),footer:L(()=>[t("div",{class:"modal-footer"},[ha,t("button",{type:"button",class:"btn btn-success",onClick:C},"Да")])]),_:1}),m(v).isAuthorized&&m(M)?(i(),J(we,{key:9})):w("",!0),t("div",{class:"to-left",onClick:R[10]||(R[10]=T=>m(s).changePosition(!1))}),t("div",{class:"to-right",onClick:R[11]||(R[11]=T=>m(s).changePosition())})])])}}};export{fa as _,Kt as a,he as u};
